***************************
* SET UP THE INITIAL DATA *
***************************

NAME          KOEBHELB

*   Problem :
*   *********

*   An exponential fitting problem arising in the study of the
*   Koebl-Helbling conjecture on energy/time budgets and travel mode.
*   This is the raw data (KHb4).

*   Source:  
*   J. P. Hubert and Ph. L . Toint, Summer 2005.
*   SIF input: Ph. Toint, June 2005.

*   classification SBR2-RN-3-0

*   Useful constants

 IE 1                    1

*   Number of data points

 IE M                    156

*   The data points (value of budget)

 RE X1                   0.0311817898
 RE X2                   0.0467726848
 RE X3                   0.0623635797
 RE X4                   0.0935453695
 RE X5                   0.1091362644
 RE X6                   0.1247271593
 RE X7                   0.1403180543
 RE X8                   0.1559089492
 RE X9                   0.1714998441
 RE X10                  0.187090739
 RE X11                  0.2026816339
 RE X12                  0.2182725288
 RE X13                  0.2338634238
 RE X14                  0.2494543187
 RE X15                  0.2650452136
 RE X16                  0.2806361085
 RE X17                  0.2962270034
 RE X18                  0.3118178983
 RE X19                  0.3274087933
 RE X20                  0.3585905831
 RE X21                  0.374181478
 RE X22                  0.3897723729
 RE X23                  0.4053632679
 RE X24                  0.4209541628
 RE X25                  0.4365450577
 RE X26                  0.4521359526
 RE X27                  0.4677268475
 RE X28                  0.4833177424
 RE X29                  0.4989086374
 RE X30                  0.5144995323
 RE X31                  0.5300904272
 RE X32                  0.5456813221
 RE X33                  0.561272217
 RE X34                  0.5768631119
 RE X35                  0.5924540069
 RE X36                  0.6080449018
 RE X37                  0.6236357967
 RE X38                  0.6392266916
 RE X39                  0.6548175865
 RE X40                  0.6704084814
 RE X41                  0.6859993764
 RE X42                  0.7015902713
 RE X43                  0.7171811662
 RE X44                  0.7327720611
 RE X45                  0.748362956
 RE X46                  0.763953851
 RE X47                  0.7795447459
 RE X48                  0.7951356408
 RE X49                  0.8107265357
 RE X50                  0.8263174306
 RE X51                  0.8419083255
 RE X52                  0.8574992205
 RE X53                  0.8730901154
 RE X54                  0.8886810103
 RE X55                  0.9042719052
 RE X56                  0.9198628001
 RE X57                  0.935453695
 RE X58                  0.9666354849
 RE X59                  0.9978172747
 RE X60                  1.0134081696
 RE X61                  1.0289990645
 RE X62                  1.0445899595
 RE X63                  1.0601808544
 RE X64                  1.0757717493
 RE X65                  1.0913626442
 RE X66                  1.1069535391
 RE X67                  1.1225444341
 RE X68                  1.138135329
 RE X69                  1.1537262239
 RE X70                  1.1693171188
 RE X71                  1.1849080137
 RE X72                  1.2004989086
 RE X73                  1.2160898036
 RE X74                  1.2472715934
 RE X75                  1.2628624883
 RE X76                  1.2784533832
 RE X77                  1.2940442781
 RE X78                  1.325226068
 RE X79                  1.3408169629
 RE X80                  1.3564078578
 RE X81                  1.3719987527
 RE X82                  1.3875896476
 RE X83                  1.4031805426
 RE X84                  1.4187714375
 RE X85                  1.4343623324
 RE X86                  1.4811350171
 RE X87                  1.4967259121
 RE X88                  1.5279077019
 RE X89                  1.5434985968
 RE X90                  1.5590894917
 RE X91                  1.5746803867
 RE X92                  1.5902712816
 RE X93                  1.6214530714
 RE X94                  1.6370439663
 RE X95                  1.6526348612
 RE X96                  1.6682257562
 RE X97                  1.6838166511
 RE X98                  1.699407546
 RE X99                  1.7149984409
 RE X100                 1.7305893358
 RE X101                 1.7461802307
 RE X102                 1.7617711257
 RE X103                 1.7929529155
 RE X104                 1.8085438104
 RE X105                 1.8241347053
 RE X106                 1.8397256002
 RE X107                 1.8553164952
 RE X108                 1.8709073901
 RE X109                 1.886498285
 RE X110                 1.9020891799
 RE X111                 1.9332709698
 RE X112                 1.9488618647
 RE X113                 1.9644527596
 RE X114                 2.0268163393
 RE X115                 2.0579981291
 RE X116                 2.0891799189
 RE X117                 2.1515434986
 RE X118                 2.1827252884
 RE X119                 2.1983161833
 RE X120                 2.260679763
 RE X121                 2.3230433427
 RE X122                 2.3386342376
 RE X123                 2.3698160274
 RE X124                 2.4165887122
 RE X125                 2.4321796071
 RE X126                 2.447770502
 RE X127                 2.4945431868
 RE X128                 2.5413158715
 RE X129                 2.5724976614
 RE X130                 2.650452136
 RE X131                 2.7284066105
 RE X132                 2.7439975055
 RE X133                 2.7751792953
 RE X134                 2.8063610851
 RE X135                 2.8843155597
 RE X136                 2.9622700343
 RE X137                 3.0402245089
 RE X138                 3.0869971936
 RE X139                 3.1961334581
 RE X140                 3.2740879326
 RE X141                 3.5391331462
 RE X142                 3.585905831
 RE X143                 3.8977237293
 RE X144                 4.0068599938
 RE X145                 4.2095416277
 RE X146                 4.2874961023
 RE X147                 4.4434050514
 RE X148                 5.1449953227
 RE X149                 5.3788587465
 RE X150                 5.5347676957
 RE X151                 5.7062675398
 RE X152                 5.9245400686
 RE X153                 6.5325849704
 RE X154                 6.5481758653
 RE X155                 6.9067664484
 RE X156                 10.289990645

*    The (raw) data values (budget frequency in sample)

 RE Y1                   1.3956745794
 RE Y2                   0.0384714261
 RE Y3                   0.3193189404
 RE Y4                   0.5457529491
 RE Y5                   0.0883981929
 RE Y6                   0.162971961
 RE Y7                   0.5158295749
 RE Y8                   3.0658172906
 RE Y9                   0.0617811148
 RE Y10                  0.4223486827
 RE Y11                  0.3487897418
 RE Y12                  1.2541371542
 RE Y13                  0.8066406155
 RE Y14                  0.297642996
 RE Y15                  0.6365466443
 RE Y16                  0.7314860091
 RE Y17                  0.1788114646
 RE Y18                  5.8490190447
 RE Y19                  0.211425133
 RE Y20                  0.0990105163
 RE Y21                  0.5138185043
 RE Y22                  0.6597743452
 RE Y23                  0.4394819543
 RE Y24                  0.2870924367
 RE Y25                  0.4275199289
 RE Y26                  0.9889318261
 RE Y27                  4.5672071694
 RE Y28                  0.1438254325
 RE Y29                  0.2308134346
 RE Y30                  0.6534769505
 RE Y31                  0.3490464548
 RE Y32                  0.6583892973
 RE Y33                  0.2433901866
 RE Y34                  0.198643958
 RE Y35                  0.1130796292
 RE Y36                  0.0273247242
 RE Y37                  3.309046781
 RE Y38                  0.1149290926
 RE Y39                  0.6052801272
 RE Y40                  0.2745202396
 RE Y41                  0.3180914914
 RE Y42                  0.7664361487
 RE Y43                  0.8697382728
 RE Y44                  0.1393734929
 RE Y45                  0.0849025959
 RE Y46                  0.1816229186
 RE Y47                  1.7967266481
 RE Y48                  0.2437414589
 RE Y49                  0.2933083901
 RE Y50                  0.042250701
 RE Y51                  0.3265409757
 RE Y52                  0.6153127055
 RE Y53                  0.2089602142
 RE Y54                  0.1724364547
 RE Y55                  0.2969836316
 RE Y56                  0.309713792
 RE Y57                  2.7249193336
 RE Y58                  0.3298656736
 RE Y59                  0.1186460567
 RE Y60                  0.9386359319
 RE Y61                  0.1939123488
 RE Y62                  0.0467489182
 RE Y63                  0.3046529561
 RE Y64                  0.1286775419
 RE Y65                  1.4518449932
 RE Y66                  0.3585947583
 RE Y67                  0.0895309004
 RE Y68                  0.061870937
 RE Y69                  0.7399141765
 RE Y70                  2.1553128432
 RE Y71                  0.1747927852
 RE Y72                  0.2304228081
 RE Y73                  0.1697233861
 RE Y74                  1.275355242
 RE Y75                  0.0712896998
 RE Y76                  0.0612039204
 RE Y77                  0.1071958176
 RE Y78                  0.5106876621
 RE Y79                  0.2669877437
 RE Y80                  0.1639490738
 RE Y81                  0.2165907312
 RE Y82                  0.1169831612
 RE Y83                  0.4807615549
 RE Y84                  0.1103499808
 RE Y85                  0.1174473945
 RE Y86                  0.5438601232
 RE Y87                  0.0883981929
 RE Y88                  0.0187544445
 RE Y89                  0.0883981929
 RE Y90                  0.70860539
 RE Y91                  0.0597855309
 RE Y92                  0.2098301963
 RE Y93                  0.0335213649
 RE Y94                  0.4866382609
 RE Y95                  0.0382484192
 RE Y96                  0.0956645016
 RE Y97                  0.0543774309
 RE Y98                  0.0391123888
 RE Y99                  0.3967863326
 RE Y100                 0.4353064048
 RE Y101                 0.0712896998
 RE Y102                 0.2150814262
 RE Y103                 0.1271957484
 RE Y104                 0.0883981929
 RE Y105                 0.0918354874
 RE Y106                 0.4377997461
 RE Y107                 0.032532956
 RE Y108                 1.0291751004
 RE Y109                 0.0670427298
 RE Y110                 0.0533462061
 RE Y111                 0.2390568561
 RE Y112                 0.1410516929
 RE Y113                 0.0970719594
 RE Y114                 0.2000191673
 RE Y115                 0.0729323716
 RE Y116                 0.0883981929
 RE Y117                 0.0360908637
 RE Y118                 0.3245393793
 RE Y119                 0.1608286168
 RE Y120                 0.1734383461
 RE Y121                 0.164108859
 RE Y122                 0.2549304302
 RE Y123                 0.0196000124
 RE Y124                 0.050492665
 RE Y125                 0.0509505215
 RE Y126                 0.0724721466
 RE Y127                 0.2696880586
 RE Y128                 0.0309187066
 RE Y129                 0.2193032532
 RE Y130                 0.1351492974
 RE Y131                 0.4301613948
 RE Y132                 0.0617811148
 RE Y133                 0.1805670975
 RE Y134                 0.1960626165
 RE Y135                 0.0592515167
 RE Y136                 0.0813769367
 RE Y137                 0.1659411961
 RE Y138                 0.0670427298
 RE Y139                 0.1158213024
 RE Y140                 0.0913643306
 RE Y141                 0.0229555012
 RE Y142                 0.0387518245
 RE Y143                 0.0558193237
 RE Y144                 0.4043876983
 RE Y145                 0.0770268442
 RE Y146                 0.050492665
 RE Y147                 0.0360205364
 RE Y148                 0.1309783028
 RE Y149                 0.0314900707
 RE Y150                 0.0314900707
 RE Y151                 0.1477355235
 RE Y152                 0.0758846626
 RE Y153                 0.1453159714
 RE Y154                 0.8371665092
 RE Y155                 0.0355012801
 RE Y156                 0.0391123888

VARIABLES

    N
    A
    B

GROUPS

 DO I         1                        M
 XN O(I)
 OD I

CONSTANTS

 DO I         1                        M
 Z            O(I)                     Y(I)
 OD I

BOUNDS

 FR           A
 LO           B          0.001

START POINT

*   Reasonable starting point
*             N          2.5
*             A          0.2
*             B          0.7

*   Not so reasonable starting point
              N          10.0
              A          0.01
              B          0.01

ELEMENT TYPE

 EV KHE       VN                       VA
 EV KHE       VB
 EP KHE       XX

ELEMENT USES

 XT 'DEFAULT' KHE
 DO I         1                        M
 ZV E(I)      VN                       N
 ZV E(I)      VA                       A
 ZV E(I)      VB                       B
 ZP E(I)      XX                       X(I)
 OD I

GROUP TYPE

 GV L2        GVAR

GROUP USES

 T  'DEFAULT' L2
 DO I         1                        M
 XE O(I)      E(I)
 OD I

OBJECT BOUND

 LO                       0.0

*   Solution

*LO SOLTN                 77.516347286

ENDATA

***********************
* SET UP THE FUNCTION *
* AND RANGE ROUTINES  *
***********************

ELEMENTS      KOEBHELB

TEMPORARIES

 R  T
 R  M1OX
 R  XOB2
 R  M2XOB3

INDIVIDUALS

 T  KHE
 A  T                   EXP( - VA / XX - XX / VB )
 A  M1OX                - 1.0 / XX
 A  XOB2                XX / ( VB * VB )
 A  M2XOB3              - 2.0 * XX / VB**3
 F                      VN * T 
 G  VN                  T
 G  VA                  VN * T * M1OX
 G  VB                  VN * T * XOB2
 H  VN        VA        T * M1OX  
 H  VN        VB        T * XOB2
 H  VA        VA        VN * T * M1OX * M1OX     
 H  VA        VB        VN * T * M1OX * XOB2
 H  VB        VB        VN * T * ( XOB2 * XOB2 + M2XOB3 )

ENDATA

*********************
* SET UP THE GROUPS *
* ROUTINE           *
*********************

GROUPS        KOEBHELB

INDIVIDUALS

 T  L2
 F                      GVAR * GVAR
 G                      GVAR + GVAR
 H                      2.0

ENDATA
